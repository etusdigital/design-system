import { Canvas, Meta, Controls } from '@storybook/blocks';
import * as Table from './Table.stories.ts';

<Meta of={Table} />

# Name: Table
## Component Overview

**Purpose**: A comprehensive data table component with sorting, pagination, selection, loading states, and extensive customization through slots for displaying structured data.

**Import**: Automatic - no need to import any DS components

<br />
### Playground

<Canvas of={Table.Primary} />
<Controls />

---

### Basic Usage

```vue
<template>
    <Table :headers="headers" :options="options">
        <template v-for="header in headers" v-slot:[header.value]="{ item, index }">
            <td>{{ item[header.value] }}</td>
        </template>

        <template #actions>
            <td class="flex items-center justify-end">
                <Button color="primary" variant="plain" icon="more_vert" round />
            </td>
        </template>
    </Table>
</template>

<script setup lang="ts">
const headers = [
    { label: "Name", value: "name", sortable: true },
    { label: "Age", value: "age", sortable: true },
    { label: "Membership", value: "membership" }
]

const options = [
    { name: "Joanna", age: 43, memberShip: "Platinum" },
    { name: "Jhonny", age: 23, memberShip: "Gold" },
    ...
]
</script>
```

<Canvas sourceState="none" of={Table.Primary} />

---

### Props API

#### headers
Array of column headers defining table structure. Type: `Header[]` (required)

```typescript
type Header = {
  label?: string;     // Display text for column
  value: string;      // Property key from options
  sortable?: boolean; // Enable sorting for this column
  width?: string;     // CSS width value
  align?: string;     // Text alignment: 'left', 'center', 'right'
}
```

#### options
Array of data objects to display in table rows. Type: `any[]` (required)

#### sortOptions
Configuration object for sorting settings. Type: `Options` (optional)

```typescript
type Options = {
  sortBy?: string;    // Initial column to sort by
  sortDesc?: boolean; // Initial sort direction (true = descending)
}
```

<Canvas sourceState="none" of={Table.Options} />

#### page
Current active page number. Type: `number` (default: `1`)

```vue
<template>
    <Table :headers="headers" :options="options" v-model:page="currentPage" @update:page="handlePageChange">
        ...
    </Table>
</template>

<script setup lang="ts">
import { ref } from 'vue'
const currentPage = ref(1)

const handlePageChange = (newPage: number) => {}
</script>
```

#### options-per-page
Number of options to display per page. Type: `number` (default: `10`)

```vue
<template>
    <Table 
        :headers="headers" 
        :options="options"
        v-model:options-per-page="optionsPerPage"
        @update:options-per-page="handleItemsPerPageChange"
    >
        ...
    </Table>
</template>

<script setup lang="ts">
import { ref } from 'vue'
const optionsPerPage = ref(20)

const handleItemsPerPageChange = (newItemsPerPage: number) => {}
</script>
```

#### loading
Shows skeleton loading animation. Type: `boolean` (default: `false`)

<Canvas sourceState="none" of={Table.Loading} />

#### enable-selection
Enables row selection with checkboxes. Type: `boolean` (default: `false`)

```vue
<template>
    <Table :headers="headers" :options="options" enable-selection @select-all="handleSelectAll">
        <template #select="{ item }">
            <td>
                <Checkbox v-model="item.selected" />
            </td>
        </template>
        ...
    </Table>
</template>

<script setup lang="ts">
const handleSelectAll = (selected: any) => {}
</script>
```

<Canvas sourceState="none" of={Table.Selection} />

#### enable-aggregation
Enables expandable rows for nested data. Type: `boolean` (default: `false`)

```vue
<template>
    <Table :headers="headers" :options="options" enable-aggregation>
        <template #aggregation="{ item }">
            <div class="flex items-center justify-center p-xxs rounded-full cursor-pointer hover:bg-neutral-surface-highlight">
                <icon
                    name="arrow_drop_down"
                    class="transition-transform"
                    :class="{ 'rotate-180': item.expanded }"
                    @click="item.expanded = !item.expanded"
                />
            </div>
        </template>
        ...
        <template #childs="{ item }">
            <tr v-if="item.expanded" v-for="child in item.children" :key="child.id">
                <td></td>
                <td>{{ child.name }}</td>
                <td>{{ child.value }}</td>
            </tr>
        </template>
    </Table>
</template>
```

<Canvas sourceState="none" of={Table.Aggregation} />

#### is-header-fixed
Makes header sticky during vertical scroll. Type: `boolean` (default: `false`)

<Canvas sourceState="none" of={Table.IsHeaderFixed} />

#### has-hover
Enables row hover effects. Type: `boolean` (default: `false`)

<Canvas sourceState="none" of={Table.HasHover} />

#### hide-footer
Hides pagination footer. Type: `boolean` (default: `false`)

<Canvas sourceState="none" of={Table.HideFooter} />

#### no-shadow
Removes the default shadow from the table card container. Type: `boolean` (default: `false`)

<Canvas sourceState="none" of={Table.NoShadow} />

#### number-of-options
Total number of options across all pages (used for backend pagination). Type: `number` (default: `0`)

```vue
<template>
    <Table 
        :headers="headers" 
        :options="currentPageItems"
        :render-pagination-in-back-end="true"
        :number-of-options="totalItems"
        @page-options="handlePageChange"
        @sort-by="handleSort"
      >
        ...
    </Table>
</template>

<script setup lang="ts">
const handlePageChange = (page: number, optionsPerPage: number) => {}

const handleSort = (key: string, isDesc: boolean) => {}
</script>
```

#### render-pagination-in-back-end
Enables backend pagination mode. Type: `boolean` (default: `false`)

---

### Events API

#### update:page
Emitted when the current page changes (v-model:page). Receives the new page number.

#### update:options-per-page
Emitted when the options per page selection changes (v-model:options-per-page). Receives the new options per page count.

#### @sort-by
Triggered when a column header is clicked for sorting.

#### @page-options
Triggered when pagination changes (page or options per page).

#### @select-all
Triggered when the "select all" checkbox is toggled.

---

### Slots API

#### Dynamic Column Slots (`#{header.value}`)
For each header, a slot is created with the header's `value` as the slot name.

```vue
<template>
    <Table :headers="headers" :options="options">
        <template v-for="header in headers" v-slot:[header.value]="{ item, index }">
            <td>{{ item[header.value] }}</td>
        </template>
    </Table>
</template>
```

#### #actions
Displays action buttons or controls for each row.

```vue
<template>
    <Table :headers="headers" :options="options">
        ...
        <template #actions="{ item }">
            <td class="flex items-center justify-end">
                <Button
                    color="primary"
                    variant="plain"
                    icon="more_vert"
                    round
                    @click="() => handleActions(item)"
                />
            </td>
        </template>
    </Table>
</template>

<script setup lang="ts">
const handleActions = (item) => {}
</script>
```

#### #select
Custom selection controls when `enableSelection` is true.

#### #aggregation
Expand/collapse controls when `enableAggregation` is true.

#### #childs
Renders nested/child rows when parent row is expanded.

#### #empty-state
Displayed when no options are available.

```vue
<template>
    <Table :headers="headers" :options="options">
          <template #empty-state>
              <div class="flex items-center justify-center p-xxs rounded-full text-xl">
                  <Icon name="sentiment_dissatisfied" size="1em" />
              </div>
          </template>
      </Table>
</template>
```

<Canvas sourceState="none" of={Table.EmptyState} />

#### #footer
Custom table footer content.

<Canvas sourceState="none" of={Table.Footer} />

#### #options-per-page
Custom text for pagination controls.

<Canvas sourceState="none" of={Table.ItemsPerPage} />

#### #showing-page
Custom pagination info text.

<Canvas sourceState="none" of={Table.ShowingPage} />

**Important Notes:**
- The table automatically handles sorting, pagination, and selection when not in backend mode
- Slot parameters provide access to `item` (row data) and `index` (row number)
- Use `renderPaginationInBackEnd` for large datasets with server-side pagination